<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>理解 Spring Data Jpa | 江南一点雨</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="https://open.weixin.qq.com/qr/code?username=a_javaboy">
    <meta name="description" content="">
    <link rel="preload" href="/assets/css/0.styles.3f949b7f.css" as="style"><link rel="preload" href="/assets/js/app.93cfb041.js" as="script"><link rel="preload" href="/assets/js/2.afd40777.js" as="script"><link rel="preload" href="/assets/js/123.adc5157d.js" as="script"><link rel="prefetch" href="/assets/js/10.f65a90e2.js"><link rel="prefetch" href="/assets/js/100.3bcf32ff.js"><link rel="prefetch" href="/assets/js/101.bd9ebd49.js"><link rel="prefetch" href="/assets/js/102.392f968e.js"><link rel="prefetch" href="/assets/js/103.afadf5bf.js"><link rel="prefetch" href="/assets/js/104.c8312846.js"><link rel="prefetch" href="/assets/js/105.97a4170a.js"><link rel="prefetch" href="/assets/js/106.9f0ef153.js"><link rel="prefetch" href="/assets/js/107.bb303c1b.js"><link rel="prefetch" href="/assets/js/108.45e76aae.js"><link rel="prefetch" href="/assets/js/109.7e4e3e84.js"><link rel="prefetch" href="/assets/js/11.5e8094b3.js"><link rel="prefetch" href="/assets/js/110.839e4506.js"><link rel="prefetch" href="/assets/js/111.50cc5969.js"><link rel="prefetch" href="/assets/js/112.715e408b.js"><link rel="prefetch" href="/assets/js/113.aaba78f1.js"><link rel="prefetch" href="/assets/js/114.6a025439.js"><link rel="prefetch" href="/assets/js/115.8b36028e.js"><link rel="prefetch" href="/assets/js/116.2aa7851e.js"><link rel="prefetch" href="/assets/js/117.75ea5460.js"><link rel="prefetch" href="/assets/js/118.26bc5dca.js"><link rel="prefetch" href="/assets/js/119.0f7df258.js"><link rel="prefetch" href="/assets/js/12.4f05d2f8.js"><link rel="prefetch" href="/assets/js/120.f7b3a0ed.js"><link rel="prefetch" href="/assets/js/121.cf863463.js"><link rel="prefetch" href="/assets/js/122.fa3cfbdb.js"><link rel="prefetch" href="/assets/js/124.fbe6a3bf.js"><link rel="prefetch" href="/assets/js/125.d3e4c526.js"><link rel="prefetch" href="/assets/js/126.2667f20c.js"><link rel="prefetch" href="/assets/js/127.a992245e.js"><link rel="prefetch" href="/assets/js/128.e2dc5f84.js"><link rel="prefetch" href="/assets/js/129.276d62b1.js"><link rel="prefetch" href="/assets/js/13.6be298bf.js"><link rel="prefetch" href="/assets/js/130.df0fd4f2.js"><link rel="prefetch" href="/assets/js/131.e4e2b4dd.js"><link rel="prefetch" href="/assets/js/132.42ac2755.js"><link rel="prefetch" href="/assets/js/133.4d19914d.js"><link rel="prefetch" href="/assets/js/134.eee5f7f1.js"><link rel="prefetch" href="/assets/js/135.63554b27.js"><link rel="prefetch" href="/assets/js/136.a6bc1760.js"><link rel="prefetch" href="/assets/js/137.5fc69fd8.js"><link rel="prefetch" href="/assets/js/138.de23da83.js"><link rel="prefetch" href="/assets/js/139.a1faeb31.js"><link rel="prefetch" href="/assets/js/14.815db104.js"><link rel="prefetch" href="/assets/js/140.95dbf73f.js"><link rel="prefetch" href="/assets/js/141.b4542eae.js"><link rel="prefetch" href="/assets/js/142.f9296937.js"><link rel="prefetch" href="/assets/js/143.9ea81dee.js"><link rel="prefetch" href="/assets/js/144.a423b13c.js"><link rel="prefetch" href="/assets/js/145.7da590a6.js"><link rel="prefetch" href="/assets/js/146.bca8af1b.js"><link rel="prefetch" href="/assets/js/147.0aa847b1.js"><link rel="prefetch" href="/assets/js/148.8e722bc5.js"><link rel="prefetch" href="/assets/js/149.082e9ce8.js"><link rel="prefetch" href="/assets/js/15.f278054c.js"><link rel="prefetch" href="/assets/js/150.57c0d03e.js"><link rel="prefetch" href="/assets/js/151.bfeac464.js"><link rel="prefetch" href="/assets/js/152.1ed78952.js"><link rel="prefetch" href="/assets/js/153.51ae1560.js"><link rel="prefetch" href="/assets/js/154.a6f7351f.js"><link rel="prefetch" href="/assets/js/155.8cb2b9b7.js"><link rel="prefetch" href="/assets/js/156.baf79d5d.js"><link rel="prefetch" href="/assets/js/157.6dc937e3.js"><link rel="prefetch" href="/assets/js/158.f9688b9c.js"><link rel="prefetch" href="/assets/js/159.9c2d77a9.js"><link rel="prefetch" href="/assets/js/16.345bdcfc.js"><link rel="prefetch" href="/assets/js/160.c928cf3c.js"><link rel="prefetch" href="/assets/js/161.5d3727ba.js"><link rel="prefetch" href="/assets/js/162.bb1e7f33.js"><link rel="prefetch" href="/assets/js/163.049f7d18.js"><link rel="prefetch" href="/assets/js/164.a480bd3f.js"><link rel="prefetch" href="/assets/js/165.c8f91cd5.js"><link rel="prefetch" href="/assets/js/166.f0a0e356.js"><link rel="prefetch" href="/assets/js/167.54930ff6.js"><link rel="prefetch" href="/assets/js/168.2702d69f.js"><link rel="prefetch" href="/assets/js/169.44923723.js"><link rel="prefetch" href="/assets/js/17.a076d059.js"><link rel="prefetch" href="/assets/js/170.0e2e92d4.js"><link rel="prefetch" href="/assets/js/171.e63c9b1d.js"><link rel="prefetch" href="/assets/js/172.c18ef95a.js"><link rel="prefetch" href="/assets/js/173.a78b9057.js"><link rel="prefetch" href="/assets/js/174.35a568dc.js"><link rel="prefetch" href="/assets/js/175.aaff1ff2.js"><link rel="prefetch" href="/assets/js/176.10d8a2e2.js"><link rel="prefetch" href="/assets/js/177.83ea0cb0.js"><link rel="prefetch" href="/assets/js/178.3c9de5ed.js"><link rel="prefetch" href="/assets/js/179.28e6d588.js"><link rel="prefetch" href="/assets/js/18.542b7e9d.js"><link rel="prefetch" href="/assets/js/180.6c49aa48.js"><link rel="prefetch" href="/assets/js/181.5a053633.js"><link rel="prefetch" href="/assets/js/182.b23e7d08.js"><link rel="prefetch" href="/assets/js/183.ee09403b.js"><link rel="prefetch" href="/assets/js/184.94593e4b.js"><link rel="prefetch" href="/assets/js/185.ea14675f.js"><link rel="prefetch" href="/assets/js/186.105f44fd.js"><link rel="prefetch" href="/assets/js/187.13bdebf6.js"><link rel="prefetch" href="/assets/js/188.df5be68c.js"><link rel="prefetch" href="/assets/js/189.8feb4ee4.js"><link rel="prefetch" href="/assets/js/19.741384a0.js"><link rel="prefetch" href="/assets/js/190.8c35be02.js"><link rel="prefetch" href="/assets/js/191.9bbb2940.js"><link rel="prefetch" href="/assets/js/192.77be398f.js"><link rel="prefetch" href="/assets/js/193.401d4d9e.js"><link rel="prefetch" href="/assets/js/194.ce411ee2.js"><link rel="prefetch" href="/assets/js/195.10a07ccc.js"><link rel="prefetch" href="/assets/js/196.74cbc7e7.js"><link rel="prefetch" href="/assets/js/197.5d03c5b7.js"><link rel="prefetch" href="/assets/js/198.c298c39b.js"><link rel="prefetch" href="/assets/js/199.29ec26b9.js"><link rel="prefetch" href="/assets/js/20.4c668583.js"><link rel="prefetch" href="/assets/js/200.9b042f85.js"><link rel="prefetch" href="/assets/js/201.ce4fe568.js"><link rel="prefetch" href="/assets/js/202.97cae704.js"><link rel="prefetch" href="/assets/js/203.9f870d68.js"><link rel="prefetch" href="/assets/js/204.2796778b.js"><link rel="prefetch" href="/assets/js/205.8efe9247.js"><link rel="prefetch" href="/assets/js/206.ff06ce73.js"><link rel="prefetch" href="/assets/js/207.0402326b.js"><link rel="prefetch" href="/assets/js/208.2bd6489b.js"><link rel="prefetch" href="/assets/js/209.ca24b4e7.js"><link rel="prefetch" href="/assets/js/21.aebbbd15.js"><link rel="prefetch" href="/assets/js/210.4d61626d.js"><link rel="prefetch" href="/assets/js/211.6c198d71.js"><link rel="prefetch" href="/assets/js/212.52494de3.js"><link rel="prefetch" href="/assets/js/213.43f986d0.js"><link rel="prefetch" href="/assets/js/214.3403d0f9.js"><link rel="prefetch" href="/assets/js/215.ba7b6da8.js"><link rel="prefetch" href="/assets/js/216.ecbe6232.js"><link rel="prefetch" href="/assets/js/217.70deb9f1.js"><link rel="prefetch" href="/assets/js/218.de783ea7.js"><link rel="prefetch" href="/assets/js/219.4efc57bc.js"><link rel="prefetch" href="/assets/js/22.f361a824.js"><link rel="prefetch" href="/assets/js/220.5dc860c4.js"><link rel="prefetch" href="/assets/js/221.7a3c5614.js"><link rel="prefetch" href="/assets/js/222.b5a275ab.js"><link rel="prefetch" href="/assets/js/223.a8ea0f32.js"><link rel="prefetch" href="/assets/js/224.b2f5c374.js"><link rel="prefetch" href="/assets/js/225.0ab9bbe5.js"><link rel="prefetch" href="/assets/js/226.73ddbdc1.js"><link rel="prefetch" href="/assets/js/227.a8617bac.js"><link rel="prefetch" href="/assets/js/228.184e2034.js"><link rel="prefetch" href="/assets/js/229.a7efe08d.js"><link rel="prefetch" href="/assets/js/23.a04c99fe.js"><link rel="prefetch" href="/assets/js/230.49a88e1b.js"><link rel="prefetch" href="/assets/js/231.a422f33e.js"><link rel="prefetch" href="/assets/js/232.c323a194.js"><link rel="prefetch" href="/assets/js/233.5edbdef4.js"><link rel="prefetch" href="/assets/js/234.9f0a13bb.js"><link rel="prefetch" href="/assets/js/235.54a4fc37.js"><link rel="prefetch" href="/assets/js/236.d2d69ec5.js"><link rel="prefetch" href="/assets/js/237.64f6dcea.js"><link rel="prefetch" href="/assets/js/238.61c501f3.js"><link rel="prefetch" href="/assets/js/239.a33bb2dd.js"><link rel="prefetch" href="/assets/js/24.5bc3cf94.js"><link rel="prefetch" href="/assets/js/240.f7f4c0ba.js"><link rel="prefetch" href="/assets/js/241.65fc5fa2.js"><link rel="prefetch" href="/assets/js/242.0491824c.js"><link rel="prefetch" href="/assets/js/243.3f9577d5.js"><link rel="prefetch" href="/assets/js/244.9649ec6d.js"><link rel="prefetch" href="/assets/js/245.fdcca161.js"><link rel="prefetch" href="/assets/js/246.c83c6714.js"><link rel="prefetch" href="/assets/js/247.6677979b.js"><link rel="prefetch" href="/assets/js/248.97ea5089.js"><link rel="prefetch" href="/assets/js/249.d7170cdf.js"><link rel="prefetch" href="/assets/js/25.b67b3873.js"><link rel="prefetch" href="/assets/js/250.8adf3d86.js"><link rel="prefetch" href="/assets/js/251.86300af7.js"><link rel="prefetch" href="/assets/js/252.0e3ede05.js"><link rel="prefetch" href="/assets/js/253.586d912a.js"><link rel="prefetch" href="/assets/js/254.f521f0b4.js"><link rel="prefetch" href="/assets/js/255.0c8cdb1a.js"><link rel="prefetch" href="/assets/js/256.ec7f9c17.js"><link rel="prefetch" href="/assets/js/257.6dc36fca.js"><link rel="prefetch" href="/assets/js/258.9930d469.js"><link rel="prefetch" href="/assets/js/259.bdc389e2.js"><link rel="prefetch" href="/assets/js/26.d41155d3.js"><link rel="prefetch" href="/assets/js/260.7244b3ab.js"><link rel="prefetch" href="/assets/js/261.a0afac4b.js"><link rel="prefetch" href="/assets/js/262.431d6a82.js"><link rel="prefetch" href="/assets/js/263.c0899c3e.js"><link rel="prefetch" href="/assets/js/264.64a2a420.js"><link rel="prefetch" href="/assets/js/265.b0cad44b.js"><link rel="prefetch" href="/assets/js/266.21b77a2f.js"><link rel="prefetch" href="/assets/js/27.3c4a072d.js"><link rel="prefetch" href="/assets/js/28.4e74f69f.js"><link rel="prefetch" href="/assets/js/29.14f28039.js"><link rel="prefetch" href="/assets/js/3.2f237a9d.js"><link rel="prefetch" href="/assets/js/30.36410792.js"><link rel="prefetch" href="/assets/js/31.6ffd719e.js"><link rel="prefetch" href="/assets/js/32.bfd5c2e9.js"><link rel="prefetch" href="/assets/js/33.16929d80.js"><link rel="prefetch" href="/assets/js/34.361a9575.js"><link rel="prefetch" href="/assets/js/35.1c66b905.js"><link rel="prefetch" href="/assets/js/36.53256ba6.js"><link rel="prefetch" href="/assets/js/37.da2558ed.js"><link rel="prefetch" href="/assets/js/38.30d9e621.js"><link rel="prefetch" href="/assets/js/39.4818defd.js"><link rel="prefetch" href="/assets/js/4.7d5f245c.js"><link rel="prefetch" href="/assets/js/40.636eea27.js"><link rel="prefetch" href="/assets/js/41.0018ba6b.js"><link rel="prefetch" href="/assets/js/42.6ecc2862.js"><link rel="prefetch" href="/assets/js/43.58a75ee3.js"><link rel="prefetch" href="/assets/js/44.74a32a06.js"><link rel="prefetch" href="/assets/js/45.03250a20.js"><link rel="prefetch" href="/assets/js/46.52f68306.js"><link rel="prefetch" href="/assets/js/47.36e85e4f.js"><link rel="prefetch" href="/assets/js/48.49d57bca.js"><link rel="prefetch" href="/assets/js/49.b38b2ad5.js"><link rel="prefetch" href="/assets/js/5.d87988f8.js"><link rel="prefetch" href="/assets/js/50.56cc433e.js"><link rel="prefetch" href="/assets/js/51.c40a0825.js"><link rel="prefetch" href="/assets/js/52.63567257.js"><link rel="prefetch" href="/assets/js/53.3e42ed99.js"><link rel="prefetch" href="/assets/js/54.2761720e.js"><link rel="prefetch" href="/assets/js/55.4cb6db86.js"><link rel="prefetch" href="/assets/js/56.469a92f3.js"><link rel="prefetch" href="/assets/js/57.46afff20.js"><link rel="prefetch" href="/assets/js/58.7ef30381.js"><link rel="prefetch" href="/assets/js/59.744cb435.js"><link rel="prefetch" href="/assets/js/6.3a554393.js"><link rel="prefetch" href="/assets/js/60.094ab0a3.js"><link rel="prefetch" href="/assets/js/61.119e8b2e.js"><link rel="prefetch" href="/assets/js/62.565108d9.js"><link rel="prefetch" href="/assets/js/63.4c7edb02.js"><link rel="prefetch" href="/assets/js/64.54bb5e4b.js"><link rel="prefetch" href="/assets/js/65.42f707a8.js"><link rel="prefetch" href="/assets/js/66.c98dc6b7.js"><link rel="prefetch" href="/assets/js/67.ba6a3acd.js"><link rel="prefetch" href="/assets/js/68.a02a3b0b.js"><link rel="prefetch" href="/assets/js/69.cd233ec0.js"><link rel="prefetch" href="/assets/js/7.bab1dbf2.js"><link rel="prefetch" href="/assets/js/70.f1295eda.js"><link rel="prefetch" href="/assets/js/71.e1d95891.js"><link rel="prefetch" href="/assets/js/72.f5c3f64f.js"><link rel="prefetch" href="/assets/js/73.9d99f345.js"><link rel="prefetch" href="/assets/js/74.ad8f1d8c.js"><link rel="prefetch" href="/assets/js/75.c9fb45f8.js"><link rel="prefetch" href="/assets/js/76.b1d611d5.js"><link rel="prefetch" href="/assets/js/77.a04577e3.js"><link rel="prefetch" href="/assets/js/78.9ba11b90.js"><link rel="prefetch" href="/assets/js/79.420221c7.js"><link rel="prefetch" href="/assets/js/8.889a2b8d.js"><link rel="prefetch" href="/assets/js/80.9ec1d712.js"><link rel="prefetch" href="/assets/js/81.ecb47b58.js"><link rel="prefetch" href="/assets/js/82.778e423a.js"><link rel="prefetch" href="/assets/js/83.2b8384d4.js"><link rel="prefetch" href="/assets/js/84.cabc5b04.js"><link rel="prefetch" href="/assets/js/85.a094bd7c.js"><link rel="prefetch" href="/assets/js/86.cc9676aa.js"><link rel="prefetch" href="/assets/js/87.8a5e2ad5.js"><link rel="prefetch" href="/assets/js/88.35140b15.js"><link rel="prefetch" href="/assets/js/89.333e2b0b.js"><link rel="prefetch" href="/assets/js/9.b81dc625.js"><link rel="prefetch" href="/assets/js/90.2faba253.js"><link rel="prefetch" href="/assets/js/91.29ab2e40.js"><link rel="prefetch" href="/assets/js/92.8fa6f536.js"><link rel="prefetch" href="/assets/js/93.15279ab5.js"><link rel="prefetch" href="/assets/js/94.b576dde8.js"><link rel="prefetch" href="/assets/js/95.00c825c5.js"><link rel="prefetch" href="/assets/js/96.cb4857a8.js"><link rel="prefetch" href="/assets/js/97.7fd4177a.js"><link rel="prefetch" href="/assets/js/98.166528c5.js"><link rel="prefetch" href="/assets/js/99.4385d414.js">
    <link rel="stylesheet" href="/assets/css/0.styles.3f949b7f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="https://open.weixin.qq.com/qr/code?username=a_javaboy" alt="江南一点雨" class="logo"> <span class="site-name can-hide">江南一点雨</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="http://www.javaboy.org" target="_blank" rel="noopener noreferrer" class="nav-link external">
  国际站
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="http://www.itboyhub.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  国内站
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="http://www.javaboy.org" target="_blank" rel="noopener noreferrer" class="nav-link external">
  国际站
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="http://www.itboyhub.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  国内站
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><a href="/ssm/" class="sidebar-heading clickable"><span>SSM</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/ssm/" class="sidebar-heading clickable open"><span>Maven</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/ssm/maven/info.html" class="sidebar-link">Maven 介绍</a></li><li><a href="/ssm/maven/install.html" class="sidebar-link">Maven 安装</a></li><li><a href="/ssm/maven/config.html" class="sidebar-link">Maven 配置</a></li><li><a href="/ssm/maven/maven.html" class="sidebar-link">Maven 常用命令</a></li><li><a href="/ssm/maven/idea.html" class="sidebar-link">IDEA 中使用 Maven</a></li><li><a href="/ssm/maven/dependency.html" class="sidebar-link">Maven 依赖管理</a></li><li><a href="/ssm/maven/nexus.html" class="sidebar-link">Maven 私服</a></li><li><a href="/ssm/maven/pom.html" class="sidebar-link">聚合工程</a></li><li><a href="/ssm/maven/download.html" class="sidebar-link">教程下载</a></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/ssm/" class="sidebar-heading clickable"><span>Spring</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/ssm/" class="sidebar-heading clickable"><span>SpringMVC</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/ssm/" class="sidebar-heading clickable"><span>MyBatis</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/ssm/" class="sidebar-heading clickable"><span>Spring 源码</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/ssm/" class="sidebar-heading clickable"><span>SpringMVC 进阶</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/ssm/" class="sidebar-heading clickable"><span>WebFlux</span> <span class="arrow right"></span></a> <!----></section></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/springboot/" class="sidebar-heading clickable router-link-active open"><span>SpringBoot</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/springboot/" class="sidebar-heading clickable router-link-active"><span>基本配置</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/springboot/" class="sidebar-heading clickable router-link-active"><span>整合视图层</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/springboot/" class="sidebar-heading clickable router-link-active"><span>Web开发</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/springboot/" class="sidebar-heading clickable router-link-active open"><span>数据持久化</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/springboot/jdbctemplate.html" class="sidebar-link">整合 JdbcTemplate</a></li><li><a href="/springboot/jdbctemplate-multidatasource.html" class="sidebar-link">整合JdbcTemplate 多数据源</a></li><li><a href="/springboot/mybatis.html" class="sidebar-link">整合 MyBatis</a></li><li><a href="/springboot/mybatis-multidatasource.html" class="sidebar-link">整合 MyBatis 多数据源</a></li><li><a href="/springboot/springdata-jpa.html" aria-current="page" class="active sidebar-link">理解 Spring Data Jpa</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/springboot/springdata-jpa.html#_1-1-jpa" class="sidebar-link">1.1 Jpa</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/springboot/springdata-jpa.html#_1-1-1-jpa-是什么" class="sidebar-link">1.1.1 JPA 是什么</a></li><li class="sidebar-sub-header"><a href="/springboot/springdata-jpa.html#_1-1-2-jpa-和-hibernate-的关系" class="sidebar-link">1.1.2 JPA 和 Hibernate 的关系</a></li><li class="sidebar-sub-header"><a href="/springboot/springdata-jpa.html#_1-1-3-jpa-的供应商" class="sidebar-link">1.1.3 JPA 的供应商</a></li><li class="sidebar-sub-header"><a href="/springboot/springdata-jpa.html#_1-1-4-jpa-的优势" class="sidebar-link">1.1.4 JPA 的优势</a></li><li class="sidebar-sub-header"><a href="/springboot/springdata-jpa.html#_1-1-5-jpa-包含的技术" class="sidebar-link">1.1.5 JPA 包含的技术</a></li></ul></li><li class="sidebar-sub-header"><a href="/springboot/springdata-jpa.html#_1-2-spring-data" class="sidebar-link">1.2 Spring Data</a></li><li class="sidebar-sub-header"><a href="/springboot/springdata-jpa.html#_2-1-jpa-的故事" class="sidebar-link">2.1 Jpa 的故事</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/springboot/springdata-jpa.html#_2-1-1-关于-jpql" class="sidebar-link">2.1.1 关于 JPQL</a></li><li class="sidebar-sub-header"><a href="/springboot/springdata-jpa.html#_2-1-2-jpql-举例" class="sidebar-link">2.1.2 JPQL 举例</a></li></ul></li><li class="sidebar-sub-header"><a href="/springboot/springdata-jpa.html#_2-2-spring-data-的故事" class="sidebar-link">2.2 Spring Data 的故事</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/springboot/springdata-jpa.html#_2-2-1-基本环境搭建" class="sidebar-link">2.2.1 基本环境搭建</a></li><li class="sidebar-sub-header"><a href="/springboot/springdata-jpa.html#_2-2-2-repository" class="sidebar-link">2.2.2 Repository</a></li><li class="sidebar-sub-header"><a href="/springboot/springdata-jpa.html#_2-2-3-方法定义规范" class="sidebar-link">2.2.3 方法定义规范</a></li></ul></li></ul></li><li><a href="/springboot/jpa.html" class="sidebar-link">整合 Jpa</a></li><li><a href="/springboot/jpa-multidatasource.html" class="sidebar-link">整合 Jpa 多数据源</a></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/springboot/" class="sidebar-heading clickable router-link-active"><span>整合 Redis</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/springboot/" class="sidebar-heading clickable router-link-active"><span>RESTful</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/springboot/" class="sidebar-heading clickable router-link-active"><span>安全管理</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/springboot/" class="sidebar-heading clickable router-link-active"><span>其他</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/springboot/" class="sidebar-heading clickable router-link-active"><span>面试题</span> <span class="arrow right"></span></a> <!----></section></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/oauth2/" class="sidebar-heading clickable"><span>OAuth2</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/oauth2/oauth2-info.html" class="sidebar-link">OAuth2 简介</a></li><li><a href="/oauth2/oauth2_authorization_code.html" class="sidebar-link">授权码模式</a></li><li><a href="/oauth2/oauth2-password-implicit.html" class="sidebar-link">四种认证模式</a></li><li><a href="/oauth2/oauth2-redis.html" class="sidebar-link">引入 Redis</a></li><li><a href="/oauth2/oauth2-jwt.html" class="sidebar-link">引入 JWT</a></li><li><a href="/oauth2/spring-cloud-oauth2.html" class="sidebar-link">微服务安全管理思路</a></li><li><a href="/oauth2/oauth2-sso.html" class="sidebar-link">单点登录</a></li><li><a href="/oauth2/github-oauth2.html" class="sidebar-link">接入 GitHub 第三方登录</a></li><li><a href="/oauth2/custom-token-info.html" class="sidebar-link">自定义返回的 Token 信息</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/springsecurity/" class="sidebar-heading clickable"><span>SpringSecurity</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/springsecurity/spring-security-guide.html" class="sidebar-link">Spring Security 简介</a></li><li><a href="/springsecurity/spring-security-form-login.html" class="sidebar-link">入门 Spring Security</a></li><li><a href="/springsecurity/spring-security-custom-formlogin.html" class="sidebar-link">定制表单登录</a></li><li><a href="/springsecurity/spring-security-json.html" class="sidebar-link">使用 JSON 交互</a></li><li><a href="/springsecurity/spring-security-authorization.html" class="sidebar-link">授权操作</a></li><li><a href="/springsecurity/spring-security-JdbcUserDetailsManager.html" class="sidebar-link">将用户数据存入数据库</a></li><li><a href="/springsecurity/springsecurity-springdatajpa.html" class="sidebar-link">Spring Data Jpa 做持久化</a></li><li><a href="/springsecurity/rememberme.html" class="sidebar-link">自动登录功能</a></li><li><a href="/springsecurity/rememberme-advance.html" class="sidebar-link">自动登录的安全风险</a></li><li><a href="/springsecurity/spring-security-vs-shiro.html" class="sidebar-link">Spring Security Vs Shiro</a></li><li><a href="/springsecurity/custom-authentication.html" class="sidebar-link">自定义认证逻辑(高级玩法)</a></li><li><a href="/springsecurity/details.html" class="sidebar-link">快速查看登录用户 IP</a></li><li><a href="/springsecurity/session-management.html" class="sidebar-link">自动踢掉前一个登录用户</a></li><li><a href="/springsecurity/springboot-vue-session-management.html" class="sidebar-link">Spring Boot + Vue 踢掉已登录用户</a></li><li><a href="/springsecurity/springsecurity-stricthttpfirewall.html" class="sidebar-link">HttpFirewall</a></li><li><a href="/springsecurity/springsecurity-sfa.html" class="sidebar-link">防御会话固定攻击</a></li><li><a href="/springsecurity/springsecurity-spring-session.html" class="sidebar-link">集群化环境处理 session 共享</a></li><li><a href="/springsecurity/springsecurity-csrf.html" class="sidebar-link">防御 CSRF 攻击</a></li><li><a href="/springsecurity/springsecurity-csrf-sourcecode.html" class="sidebar-link">CSRF 防御源码</a></li><li><a href="/springsecurity/springsecurity-passwordencoder.html" class="sidebar-link">密码加密的两种姿势</a></li><li><a href="/springsecurity/springsecurity-study.html" class="sidebar-link">Spring Security 要怎么学</a></li><li><a href="/springsecurity/springsecurity-ignoring.html" class="sidebar-link">两种资源放行策略</a></li><li><a href="/springsecurity/springsecurity-cas.html" class="sidebar-link">CAS 单点登录</a></li><li><a href="/springsecurity/springsecurity-casserver.html" class="sidebar-link">配置 CAS-Server</a></li><li><a href="/springsecurity/springsecurity-cas-mysql.html" class="sidebar-link">CAS 对接数据库</a></li><li><a href="/springsecurity/cas-login-page.html" class="sidebar-link">CAS 自定义登录页面</a></li><li><a href="/springsecurity/swagger-springsecurity.html" class="sidebar-link">在 Swagger 请求头中携带 Token</a></li><li><a href="/springsecurity/cors-springsecurity.html" class="sidebar-link">三种跨域场景总结</a></li><li><a href="/springsecurity/http-springsecurity.html" class="sidebar-link">HTTP 认证</a></li><li><a href="/springsecurity/authorize-springsecurity.html" class="sidebar-link">四种权限控制方式</a></li><li><a href="/springsecurity/passwordencoder.html" class="sidebar-link">多种加密方案共存</a></li><li><a href="/springsecurity/objectpostprocess.html" class="sidebar-link">ObjectPostProcessor</a></li><li><a href="/springsecurity/httpsecurity-and.html" class="sidebar-link">配置中的 and</a></li><li><a href="/springsecurity/springsecurity-exception.html" class="sidebar-link">异常处理机制</a></li><li><a href="/springsecurity/spring-security-securitycontext.html" class="sidebar-link">SecurityContext</a></li><li><a href="/springsecurity/springsecurity-login.html" class="sidebar-link">登录流程分析</a></li><li><a href="/springsecurity/springsecurity-vue-token.html" class="sidebar-link">文件上传携带令牌</a></li><li><a href="/springsecurity/spring-security-update-info.html" class="sidebar-link">动态更新已登录用户信息</a></li><li><a href="/springsecurity/spring-security-json-2.html" class="sidebar-link">使用 JSON 格式登录</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/redis/" class="sidebar-heading clickable"><span>Redis</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/redis/linux-redis.html" class="sidebar-link">Linux 上安装 Redis</a></li><li><a href="/redis/datatype.html" class="sidebar-link">Redis 中的五种数据类型简介</a></li><li><a href="/redis/string.html" class="sidebar-link">Redis 字符串 STRING 介绍</a></li><li><a href="/redis/string-bit.html" class="sidebar-link">BIT 相关命令</a></li><li><a href="/redis/list-set.html" class="sidebar-link">Redis 列表与集合</a></li><li><a href="/redis/hash-zset.html" class="sidebar-link">Redis 散列与有序集合</a></li><li><a href="/redis/pub-sub.html" class="sidebar-link">Redis 中的发布订阅和事务</a></li><li><a href="/redis/rdb.html" class="sidebar-link">Redis 快照持久化</a></li><li><a href="/redis/aof.html" class="sidebar-link">Redis 之 AOF 持久化</a></li><li><a href="/redis/master-slave-1.html" class="sidebar-link">Redis 主从复制(一)</a></li><li><a href="/redis/master-slave-2.html" class="sidebar-link">Redis 主从复制(二)</a></li><li><a href="/redis/cluster.html" class="sidebar-link">Redis 集群搭建</a></li><li><a href="/redis/jedis.html" class="sidebar-link">Jedis 使用</a></li><li><a href="/redis/springdata-redis.html" class="sidebar-link">Spring Data Redis 使用</a></li><li><a href="/redis/guide.html" class="sidebar-link">教程下载</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/docker/" class="sidebar-heading clickable"><span>Docker</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/docker/install.html" class="sidebar-link">入门及安装</a></li><li><a href="/docker/container-basic.html" class="sidebar-link">容器基本操作</a></li><li><a href="/docker/container-advanced.html" class="sidebar-link">容器高级操作</a></li><li><a href="/docker/images.html" class="sidebar-link">镜像基本操作</a></li><li><a href="/docker/dockerhub-newwork.html" class="sidebar-link">DockerHub 与容器网络</a></li><li><a href="/docker/data.html" class="sidebar-link">数据卷操作</a></li><li><a href="/docker/link.html" class="sidebar-link">容器连接</a></li><li><a href="/docker/container-arrangement.html" class="sidebar-link">容器编排入门</a></li><li><a href="/docker/mysql.html" class="sidebar-link">Docker 搭建 MySQL 主从复制</a></li><li><a href="/docker/download.html" class="sidebar-link">教程下载</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/mongodb/" class="sidebar-heading clickable"><span>MongoDB</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/mongodb/linux-install-mongodb.html" class="sidebar-link">Linux 上安装 MongoDB</a></li><li><a href="/mongodb/basic-operations.html" class="sidebar-link">基本操作</a></li><li><a href="/mongodb/data-types.html" class="sidebar-link">数据类型</a></li><li><a href="/mongodb/documents-update.html" class="sidebar-link">文档更新操作</a></li><li><a href="/mongodb/documents-query.html" class="sidebar-link">文档查询操作(一)</a></li><li><a href="/mongodb/documents-query-2.html" class="sidebar-link">文档查询操作(二)</a></li><li><a href="/mongodb/query-planner.html" class="sidebar-link">查看执行计划</a></li><li><a href="/mongodb/index-basic.html" class="sidebar-link">初识索引</a></li><li><a href="/mongodb/index-types.html" class="sidebar-link">各种类型的索引</a></li><li><a href="/mongodb/collections.html" class="sidebar-link">固定集合</a></li><li><a href="/mongodb/pipelines.html" class="sidebar-link">管道操作符(一)</a></li><li><a href="/mongodb/pipelines-2.html" class="sidebar-link">管道操作符(二)</a></li><li><a href="/mongodb/in-mapreduce.html" class="sidebar-link">MapReduce 使用</a></li><li><a href="/mongodb/replicaset-install.html" class="sidebar-link">副本集搭建</a></li><li><a href="/mongodb/replicaset-settings.html" class="sidebar-link">副本集配置</a></li><li><a href="/mongodb/replicaset-details.html" class="sidebar-link">副本集其他细节</a></li><li><a href="/mongodb/shard.html" class="sidebar-link">初识分片</a></li><li><a href="/mongodb/in-java.html" class="sidebar-link">Java 操作 MongoDB</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/mysql/" class="sidebar-heading clickable"><span>MySQL</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/mysql/mysql-read-write.html" class="sidebar-link">MySQL  读写分离环境搭建(一)</a></li><li><a href="/mysql/mysql-read-write-2.html" class="sidebar-link">MySQL  读写分离环境搭建(二)</a></li><li><a href="/mysql/mysql.html" class="sidebar-link">MySQL 只能做小项目？</a></li><li><a href="/mysql/mysql-sharding.html" class="sidebar-link">初识数据库切分</a></li><li><a href="/mysql/middleware.html" class="sidebar-link">What？Tomcat 竟然也算中间件？</a></li><li><a href="/mysql/mycat-install.html" class="sidebar-link">分布式数据库中间件 MyCat</a></li><li><a href="/mysql/mycat-rule.html" class="sidebar-link">数据库分片规则</a></li><li><a href="/mysql/mycat-id-autoincrement.html" class="sidebar-link">分布式数据库主键全局自增</a></li><li><a href="/mysql/mysql-high-performance.html" class="sidebar-link">给数据库减负的八个思路</a></li><li><a href="/mysql/mybatis-key-generated.html" class="sidebar-link">MyBatis 中主键回填</a></li><li><a href="/mysql/mybatis-@param.html" class="sidebar-link">MyBatis 中 @Param 注解使用场景</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/git/" class="sidebar-heading clickable"><span>Git</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/git/install.html" class="sidebar-link">Git 概述</a></li><li><a href="/git/basic.html" class="sidebar-link">Git 基本操作</a></li><li><a href="/git/delete.html" class="sidebar-link">Git 中的各种后悔药</a></li><li><a href="/git/branch.html" class="sidebar-link">Git 分支管理</a></li><li><a href="/git/remote.html" class="sidebar-link">Git 关联远程仓库</a></li><li><a href="/git/tag.html" class="sidebar-link">Git 标签管理</a></li><li><a href="/git/stash.html" class="sidebar-link">Git 工作区储藏</a></li><li><a href="/git/resources.html" class="sidebar-link">Git 学习资料</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p>有很多读者留言希望松哥能好好聊聊 Spring Data Jpa! 其实这个话题松哥以前零零散散的介绍过，在我的书里也有介绍过，但是在公众号中还没和大伙聊过，因此本文就和大家来仔细聊聊 Spring Data 和 Jpa!</p> <p>本文大纲：</p> <p><img src="http://www.javaboy.org/images/boot2/23-0.png" alt=""></p> <h1 id="_1-故事的主角"><a href="#_1-故事的主角" class="header-anchor">#</a> 1. 故事的主角</h1> <h2 id="_1-1-jpa"><a href="#_1-1-jpa" class="header-anchor">#</a> 1.1 Jpa</h2> <h3 id="_1-1-1-jpa-是什么"><a href="#_1-1-1-jpa-是什么" class="header-anchor">#</a> 1.1.1 JPA 是什么</h3> <ol><li>Java Persistence API：用于对象持久化的 API</li> <li>Java EE 5.0 平台标准的 ORM 规范，使得应用程序以统一的方式访问持久层</li></ol> <p><img src="https://mmbiz.qpic.cn/mmbiz_png/GvtDGKK4uYnJBCogaZBTYUb9QHDGLUE9ztljoWZdXicZ8s9QdWtATJcibXfmW58rAfYlYAOqOujjMXw6zKzp5hIw/0?wx_fmt=png" alt=""></p> <h3 id="_1-1-2-jpa-和-hibernate-的关系"><a href="#_1-1-2-jpa-和-hibernate-的关系" class="header-anchor">#</a> 1.1.2 JPA 和 Hibernate 的关系</h3> <ol><li>JPA 是 Hibernate 的一个抽象（就像 JDBC 和 JDBC 驱动的关系）；</li> <li>JPA 是规范：JPA 本质上就是一种 ORM 规范，不是 ORM 框架，这是因为 JPA 并未提供 ORM 实现，它只是制订了一些规范，提供了一些编程的 API 接口，但具体实现则由 ORM 厂商提供实现；</li> <li>Hibernate 是实现：Hibernate 除了作为 ORM 框架之外，它也是一种 JPA 实现</li> <li>从功能上来说， JPA 是 Hibernate 功能的一个子集</li></ol> <h3 id="_1-1-3-jpa-的供应商"><a href="#_1-1-3-jpa-的供应商" class="header-anchor">#</a> 1.1.3 JPA 的供应商</h3> <p>JPA 的目标之一是制定一个可以由很多供应商实现的 API，Hibernate 3.2+、TopLink 10.1+ 以及 OpenJPA 都提供了 JPA 的实现，Jpa 供应商有很多，常见的有如下四种：</p> <ol><li>Hibernate：JPA 的始作俑者就是 Hibernate 的作者，Hibernate 从 3.2 开始兼容 JPA。</li> <li>OpenJPA：OpenJPA 是 Apache 组织提供的开源项目。</li> <li>TopLink：TopLink 以前需要收费，如今开源了。</li> <li>EclipseLink</li></ol> <h3 id="_1-1-4-jpa-的优势"><a href="#_1-1-4-jpa-的优势" class="header-anchor">#</a> 1.1.4 JPA 的优势</h3> <ol><li>标准化: 提供相同的 API，这保证了基于 JPA 开发的企业应用能够经过少量的修改就能够在不同的 JPA 框架下运行。</li> <li>简单易用，集成方便: JPA 的主要目标之一就是提供更加简单的编程模型，在 JPA 框架下创建实体和创建 Java 类一样简单，只需要使用 javax.persistence.Entity 进行注解；JPA 的框架和接口也都非常简单。</li> <li>可媲美JDBC的查询能力: JPA的查询语言是面向对象的，JPA 定义了独特的JPQL，而且能够支持批量更新和修改、JOIN、GROUP BY、HAVING 等通常只有 SQL 才能够提供的高级查询特性，甚至还能够支持子查询。</li> <li>支持面向对象的高级特性: JPA 中能够支持面向对象的高级特性，如类之间的继承、多态和类之间的复杂关系，最大限度的使用面向对象的模型</li></ol> <h3 id="_1-1-5-jpa-包含的技术"><a href="#_1-1-5-jpa-包含的技术" class="header-anchor">#</a> 1.1.5 JPA 包含的技术</h3> <ol><li>ORM 映射元数据：JPA 支持 XML 和 JDK 5.0 注解两种元数据的形式，元数据描述对象和表之间的映射关系，框架据此将实体对象持久化到数据库表中。</li> <li>JPA 的 API：用来操作实体对象，执行CRUD操作，框架在后台完成所有的事情，开发者从繁琐的 JDBC 和 SQL 代码中解脱出来。</li> <li>查询语言（JPQL）：这是持久化操作中很重要的一个方面，通过面向对象而非面向数据库的查询语言查询数据，避免程序和具体的 SQL 紧密耦合。</li></ol> <h2 id="_1-2-spring-data"><a href="#_1-2-spring-data" class="header-anchor">#</a> 1.2 Spring Data</h2> <p>Spring Data 是 Spring 的一个子项目。用于简化数据库访问，支持NoSQL 和 关系数据存储。其主要目标是使数据库的访问变得方便快捷。Spring Data 具有如下特点：</p> <ul><li>SpringData 项目支持 NoSQL 存储：
<ol><li>MongoDB （文档数据库）</li> <li>Neo4j（图形数据库）</li> <li>Redis（键/值存储）</li> <li>Hbase（列族数据库）</li></ol></li> <li>SpringData 项目所支持的关系数据存储技术：
<ol><li>JDBC</li> <li>JPA</li></ol></li> <li>Spring Data Jpa 致力于减少数据访问层 (DAO) 的开发量. 开发者唯一要做的，就是声明持久层的接口，其他都交给 Spring Data JPA 来帮你完成</li> <li>框架怎么可能代替开发者实现业务逻辑呢？比如：当有一个UserDao.findUserById() 这样一个方法声明，大致应该能判断出这是根据给定条件的 ID 查询出满足条件的 User 对象。Spring Data JPA 做的便是规范方法的名字，根据符合规范的名字来确定方法需要实现什么样的逻辑。</li></ul> <h1 id="_2-主角的故事"><a href="#_2-主角的故事" class="header-anchor">#</a> 2. 主角的故事</h1> <h2 id="_2-1-jpa-的故事"><a href="#_2-1-jpa-的故事" class="header-anchor">#</a> 2.1 Jpa 的故事</h2> <p>为了让大伙彻底把这两个东西学会，这里我就先来介绍单纯的 Jpa 使用，然后我们再结合 Spring Data 来看 Jpa 如何使用。</p> <p>整体步骤如下：</p> <ul><li>1.使用 IntelliJ IDEA 创建项目，创建时选择 JavaEE Persistence ，如下：</li></ul> <p><img src="http://www.javaboy.org/images/boot2/23-2.png" alt=""></p> <ul><li>2.创建成功后，添加依赖 jar，由于 Jpa 只是一个规范，因此我们说用 Jpa 实际上必然是用 Jpa 的某一种实现，那么是哪一种实现呢？当然就是 Hibernate 了，所以添加的 jar，实际上来自 Hibernate，如下：</li></ul> <p><img src="http://www.javaboy.org/images/boot2/23-3.png" alt=""></p> <ul><li>3.添加实体类</li></ul> <p>接下来在项目中添加实体类，如下：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Entity</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;t_book&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Book</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> author<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Id</span>
    <span class="token annotation punctuation">@GeneratedValue</span><span class="token punctuation">(</span>strategy <span class="token operator">=</span> <span class="token class-name">GenerationType</span><span class="token punctuation">.</span>IDENTITY<span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Long</span> <span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> id<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 省略其他getter/setter</span>
<span class="token punctuation">}</span>
</code></pre></div><p>首先 @Entity 注解表示这是一个实体类，那么在项目启动时会自动针对该类生成一张表，默认的表名为类名，@Entity 注解的 name 属性表示自定义生成的表名。@Id 注解表示这个字段是一个 id，@GeneratedValue 注解表示主键的自增长策略，对于类中的其他属性，默认都会根据属性名在表中生成相应的字段，字段名和属性名相同，如果开发者想要对字段进行定制，可以使用 @Column 注解，去配置字段的名称，长度，是否为空等等。</p> <ul><li>4.创建 persistence.xml 文件</li></ul> <p>JPA 规范要求在类路径的 META-INF 目录下放置 persistence.xml，文件的名称是固定的</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>persistence</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>http://java.sun.com/xml/ns/persistence<span class="token punctuation">&quot;</span></span> <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>2.0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>persistence-unit</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>NewPersistenceUnit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">transaction-type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>RESOURCE_LOCAL<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>provider</span><span class="token punctuation">&gt;</span></span>org.hibernate.jpa.HibernatePersistenceProvider<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>provider</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>class</span><span class="token punctuation">&gt;</span></span>org.javaboy.Book<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>class</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>hibernate.connection.url<span class="token punctuation">&quot;</span></span>
                      <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>jdbc:mysql:///jpa01?useUnicode=true<span class="token entity" title="&amp;">&amp;amp;</span>characterEncoding=UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>hibernate.connection.driver_class<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>com.mysql.jdbc.Driver<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>hibernate.connection.username<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>root<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>hibernate.connection.password<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>123<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>hibernate.archive.autodetection<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>class<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>hibernate.show_sql<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>hibernate.format_sql<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>hibernate.hbm2ddl.auto<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>update<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>persistence-unit</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>persistence</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>注意：</p> <ol><li>persistence-unit 的 name 属性用于定义持久化单元的名字, 必填。</li> <li>transaction-type：指定 JPA 的事务处理策略。RESOURCE_LOCAL：默认值，数据库级别的事务，只能针对一种数据库，不支持分布式事务。如果需要支持分布式事务，使用JTA：transaction-type=&quot;JTA&quot;</li> <li>class 节点表示显式的列出实体类</li> <li>properties 中的配置分为两部分：数据库连接信息以及Hibernate信息</li></ol> <ul><li>5.执行持久化操作</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">EntityManagerFactory</span> entityManagerFactory <span class="token operator">=</span> <span class="token class-name">Persistence</span><span class="token punctuation">.</span><span class="token function">createEntityManagerFactory</span><span class="token punctuation">(</span><span class="token string">&quot;NewPersistenceUnit&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">EntityManager</span> manager <span class="token operator">=</span> entityManagerFactory<span class="token punctuation">.</span><span class="token function">createEntityManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">EntityTransaction</span> transaction <span class="token operator">=</span> manager<span class="token punctuation">.</span><span class="token function">getTransaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
transaction<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Book</span> book <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Book</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
book<span class="token punctuation">.</span><span class="token function">setAuthor</span><span class="token punctuation">(</span><span class="token string">&quot;罗贯中&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
book<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&quot;三国演义&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
manager<span class="token punctuation">.</span><span class="token function">persist</span><span class="token punctuation">(</span>book<span class="token punctuation">)</span><span class="token punctuation">;</span>
transaction<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
manager<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
entityManagerFactory<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>这里首先根据配置文件创建出来一个 EntityManagerFactory ，然后再根据 EntityManagerFactory 的实例创建出来一个 EntityManager ，然后再开启事务，调用 EntityManager 中的 persist 方法执行一次持久化操作，最后提交事务，执行完这些操作后，数据库中旧多出来一个 t_book 表，并且表中有一条数据。</p> <h3 id="_2-1-1-关于-jpql"><a href="#_2-1-1-关于-jpql" class="header-anchor">#</a> 2.1.1 关于 JPQL</h3> <ol><li>JPQL 语言，即 Java Persistence Query Language 的简称。JPQL 是一种和 SQL 非常类似的中间性和对象化查询语言，它最终会被编译成针对不同底层数据库的 SQL 查询，从而屏蔽不同数据库的差异。JPQL语言的语句可以是 select 语句、update 语句或 delete 语句，它们都通过 Query 接口封装执行。</li> <li>Query接口封装了执行数据库查询的相关方法。调用 EntityManager 的 createQuery、create NamedQuery 及 createNativeQuery 方法可以获得查询对象，进而可调用 Query 接口的相关方法来执行查询操作。</li> <li>Query接口的主要方法如下：</li></ol> <ul><li><strong>int executeUpdate();</strong> | 用于执行update或delete语句。</li> <li><strong>List getResultList();</strong> | 用于执行select语句并返回结果集实体列表。</li> <li><strong>Object getSingleResult();</strong> | 用于执行只返回单个结果实体的select语句。</li> <li><strong>Query setFirstResult(int startPosition);</strong> | 用于设置从哪个实体记录开始返回查询结果。</li> <li><strong>Query setMaxResults(int maxResult);</strong> | 用于设置返回结果实体的最大数。与setFirstResult结合使用可实现分页查询。</li> <li><strong>Query setFlushMode(FlushModeType flushMode);</strong> | 设置查询对象的Flush模式。参数可以取2个枚举值：FlushModeType.AUTO 为自动更新数据库记录，FlushMode Type.COMMIT 为直到提交事务时才更新数据库记录。</li> <li><strong>setHint(String hintName, Object value);</strong> | 设置与查询对象相关的特定供应商参数或提示信息。参数名及其取值需要参考特定 JPA 实现库提供商的文档。如果第二个参数无效将抛出IllegalArgumentException异常。</li> <li><strong>setParameter(int position, Object value);</strong> | 为查询语句的指定位置参数赋值。Position 指定参数序号，value 为赋给参数的值。</li> <li><strong>setParameter(int position, Date d, TemporalType type);</strong> | 为查询语句的指定位置参数赋 Date 值。Position 指定参数序号，value 为赋给参数的值，temporalType 取 TemporalType 的枚举常量，包括 DATE、TIME 及 TIMESTAMP 三个，，用于将 Java 的 Date 型值临时转换为数据库支持的日期时间类型（java.sql.Date、java.sql.Time及java.sql.Timestamp）。</li> <li><strong>setParameter(int position, Calendar c, TemporalType type);</strong> | 为查询语句的指定位置参数赋 Calenda r值。position 指定参数序号，value 为赋给参数的值，temporalType 的含义及取舍同前。</li> <li><strong>setParameter(String name, Object value);</strong> | 为查询语句的指定名称参数赋值。</li> <li><strong>setParameter(String name, Date d, TemporalType type);</strong> | 为查询语句的指定名称参数赋 Date 值,用法同前。</li> <li><strong>setParameter(String name, Calendar c, TemporalType type);</strong> | 为查询语句的指定名称参数设置Calendar值。name为参数名，其它同前。该方法调用时如果参数位置或参数名不正确，或者所赋的参数值类型不匹配，将抛出 IllegalArgumentException 异常。</li></ul> <h3 id="_2-1-2-jpql-举例"><a href="#_2-1-2-jpql-举例" class="header-anchor">#</a> 2.1.2 JPQL 举例</h3> <p>和在 SQL 中一样，JPQL 中的 select 语句用于执行查询。其语法可表示为：</p> <p><code>select_clause form_clause [where_clause] [groupby_clause] [having_clause] [orderby_clause]</code></p> <p>其中：</p> <ol><li>from 子句是查询语句的必选子句。</li> <li>select 用来指定查询返回的结果实体或实体的某些属性。</li> <li>from 子句声明查询源实体类，并指定标识符变量（相当于SQL表的别名）。</li> <li>如果不希望返回重复实体，可使用关键字 distinct 修饰。select、from 都是 JPQL 的关键字，通常全大写或全小写，建议不要大小写混用。</li></ol> <p>在 JPQL 中，查询所有实体的 JPQL 查询语句很简单，如下：</p> <p><code>select o from Order o</code></p> <p>或</p> <p><code>select o from Order as o</code></p> <p>这里关键字 as 可以省去，标识符变量的命名规范与 Java 标识符相同，且区分大小写,调用 EntityManager 的 createQuery() 方法可创建查询对象，接着调用 Query 接口的 getResultList() 方法就可获得查询结果集，如下：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Query</span> query <span class="token operator">=</span> entityManager<span class="token punctuation">.</span><span class="token function">createQuery</span><span class="token punctuation">(</span> <span class="token string">&quot;select o from Order o&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token class-name">List</span> orders <span class="token operator">=</span> query<span class="token punctuation">.</span><span class="token function">getResultList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Iterator</span> iterator <span class="token operator">=</span> orders<span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">while</span><span class="token punctuation">(</span>iterator<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 处理Order</span>
<span class="token punctuation">}</span>
</code></pre></div><p>其他方法的与此类似，这里不再赘述。</p> <h2 id="_2-2-spring-data-的故事"><a href="#_2-2-spring-data-的故事" class="header-anchor">#</a> 2.2 Spring Data 的故事</h2> <p>在 Spring Boot 中，Spring Data Jpa 官方封装了太多东西了，导致很多人用的时候不知道底层到底是怎么配置的，本文就和大伙来看看在手工的 Spring 环境下，Spring Data Jpa 要怎么配置，配置完成后，用法和 Spring Boot 中的用法是一致的。</p> <h3 id="_2-2-1-基本环境搭建"><a href="#_2-2-1-基本环境搭建" class="header-anchor">#</a> 2.2.1 基本环境搭建</h3> <p>首先创建一个普通的 Maven 工程，并添加如下依赖：</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-orm<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>5.0.2.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-oxm<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>5.0.2.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-aop<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>5.0.2.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-aspects<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>5.0.2.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>mysql<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mysql-connector-java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>5.1.27<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-context-support<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>5.0.2.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-expression<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>5.0.2.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.hibernate<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>hibernate-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>5.2.12.Final<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.hibernate<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>hibernate-jpamodelgen<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>5.2.12.Final<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>druid<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.0.29<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.data<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-data-jpa<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.11.3.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>这里除了 Jpa 的依赖之外，就是 Spring Data Jpa 的依赖了。</p> <p>接下来创建一个 User 实体类，创建方式参考 Jpa 中实体类的创建方式，这里不再赘述。</p> <p>接下来在 resources 目录下创建一个 applicationContext.xml 文件，并配置Spring  和 Jpa，如下：</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">context:</span>property-placeholder</span> <span class="token attr-name">location</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>classpath:db.properties<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">context:</span>component-scan</span> <span class="token attr-name">base-package</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>org.javaboy<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>com.alibaba.druid.pool.DruidDataSource<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>dataSource<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>driverClassName<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>${db.driver}<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>url<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>${db.url}<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>username<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>${db.username}<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>password<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>${db.password}<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>entityManagerFactory<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>dataSource<span class="token punctuation">&quot;</span></span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>dataSource<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>jpaVendorAdapter<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>packagesToScan<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>org.javaboy.model<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>jpaProperties<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>props</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>prop</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>hibernate.show_sql<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>prop</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>prop</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>hibernate.format_sql<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>prop</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>prop</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>hibernate.hbm2ddl.auto<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>update<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>prop</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>prop</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>hibernate.dialect<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>org.hibernate.dialect.MySQL57Dialect<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>prop</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>props</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>org.springframework.orm.jpa.JpaTransactionManager<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>transactionManager<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>entityManagerFactory<span class="token punctuation">&quot;</span></span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>entityManagerFactory<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">tx:</span>annotation-driven</span> <span class="token attr-name">transaction-manager</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>transactionManager<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token comment">&lt;!-- 配置jpa --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">jpa:</span>repositories</span> <span class="token attr-name">base-package</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>org.javaboy.dao<span class="token punctuation">&quot;</span></span>
                  <span class="token attr-name">entity-manager-factory-ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>entityManagerFactory<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>

</code></pre></div><p>这里和 Jpa 相关的配置主要是三个:</p> <ul><li>一个是 entityManagerFactory</li> <li>一个是 Jpa 的事务</li> <li>一个是配置 dao 的位置</li></ul> <p>配置完成后，就可以在 org.javaboy.dao 包下创建相应的 Repository 了，如下：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UserDao</span> <span class="token keyword">extends</span> <span class="token class-name">Repository</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">,</span> <span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token class-name">User</span> <span class="token function">getUserById</span><span class="token punctuation">(</span><span class="token class-name">Long</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>getUserById 表示根据 id 去查询 User 对象，只要我们的方法名称符合类似的规范，就不需要写 SQL，具体的规范一会来说。好了，接下来，创建 Service 和 Controller 来调用这个方法，如下：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Service</span>
<span class="token annotation punctuation">@Transactional</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserService</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Resource</span>
    <span class="token class-name">UserDao</span> userDao<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">User</span> <span class="token function">getUserById</span><span class="token punctuation">(</span><span class="token class-name">Long</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> userDao<span class="token punctuation">.</span><span class="token function">getUserById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">ClassPathXmlApplicationContext</span> ctx <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ClassPathXmlApplicationContext</span><span class="token punctuation">(</span><span class="token string">&quot;applicationContext.xml&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">UserService</span> userService <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token class-name">UserService</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">User</span> user <span class="token operator">=</span> userService<span class="token punctuation">.</span><span class="token function">getUserById</span><span class="token punctuation">(</span><span class="token number">1L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这样，就可以查询到 id 为 1 的用户了。</p> <h3 id="_2-2-2-repository"><a href="#_2-2-2-repository" class="header-anchor">#</a> 2.2.2 Repository</h3> <p>上文我们自定义的 UserDao 实现了 Repository 接口，这个 Repository 接口是什么来头呢？</p> <p>首先来看 Repository 的一个继承关系图：</p> <p><img src="http://www.javaboy.org/images/boot2/23-4.png" alt=""></p> <p>可以看到，实现类不少。那么到底如何理解 Repository 呢？</p> <ol><li>Repository 接口是 Spring Data 的一个核心接口，它不提供任何方法，开发者需要在自己定义的接口中声明需要的方法 <code>public interface Repository&lt;T, ID extends Serializable&gt; { }</code></li> <li>若我们定义的接口继承了 Repository, 则该接口会被 IOC 容器识别为一个 Repository Bean，进而纳入到 IOC 容器中，进而可以在该接口中定义满足一定规范的方法。</li> <li>Spring Data可以让我们只定义接口，只要遵循 Spring Data 的规范，就无需写实现类。</li> <li>与继承 Repository 等价的一种方式，就是在持久层接口上使用 @RepositoryDefinition 注解，并为其指定 domainClass 和 idClass 属性。像下面这样：</li></ol> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@RepositoryDefinition</span><span class="token punctuation">(</span>domainClass <span class="token operator">=</span> <span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> idClass <span class="token operator">=</span> <span class="token class-name">Long</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UserDao</span>
<span class="token punctuation">{</span>
    <span class="token class-name">User</span> <span class="token function">findById</span><span class="token punctuation">(</span><span class="token class-name">Long</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> <span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>基础的 Repository 提供了最基本的数据访问功能，其几个子接口则扩展了一些功能，它的几个常用的实现类如下：</p> <ul><li>CrudRepository： 继承 Repository，实现了一组 CRUD 相关的方法</li> <li>PagingAndSortingRepository： 继承 CrudRepository，实现了一组分页排序相关的方法</li> <li>JpaRepository： 继承 PagingAndSortingRepository，实现一组 JPA 规范相关的方法</li> <li>自定义的 XxxxRepository 需要继承 JpaRepository，这样的 XxxxRepository 接口就具备了通用的数据访问控制层的能力。</li> <li>JpaSpecificationExecutor： 不属于Repository 体系，实现一组 JPA Criteria 查询相关的方法</li></ul> <h3 id="_2-2-3-方法定义规范"><a href="#_2-2-3-方法定义规范" class="header-anchor">#</a> 2.2.3 方法定义规范</h3> <h4 id="_2-2-3-1-简单条件查询"><a href="#_2-2-3-1-简单条件查询" class="header-anchor">#</a> 2.2.3.1 简单条件查询</h4> <ul><li>按照 Spring Data 的规范，查询方法以 find | read | get 开头</li> <li>涉及条件查询时，条件的属性用条件关键字连接，要注意的是：条件属性以首字母大写</li></ul> <p>例如：定义一个 Entity 实体类：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">User</span>｛ 
   <span class="token keyword">private</span> <span class="token class-name">String</span> firstName<span class="token punctuation">;</span> 
   <span class="token keyword">private</span> <span class="token class-name">String</span> lastName<span class="token punctuation">;</span> 
｝
</code></pre></div><p>使用 And 条件连接时，条件的属性名称与个数要与参数的位置与个数一一对应，如下：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token function">findByLastNameAndFirstName</span><span class="token punctuation">(</span><span class="token class-name">String</span> lastName<span class="token punctuation">,</span><span class="token class-name">String</span> firstName<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>支持属性的级联查询. 若当前类有符合条件的属性, 则优先使用, 而不使用级联属性. 若需要使用级联属性, 则属性之间使用 <code>_</code> 进行连接.</li></ul> <p>查询举例：</p> <ul><li>按照 id 查询</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">User</span> <span class="token function">getUserById</span><span class="token punctuation">(</span><span class="token class-name">Long</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">User</span> <span class="token function">getById</span><span class="token punctuation">(</span><span class="token class-name">Long</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>查询所有年龄小于 90 岁的人</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> <span class="token function">findByAgeLessThan</span><span class="token punctuation">(</span><span class="token class-name">Long</span> age<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>查询所有姓赵的人</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> <span class="token function">findByUsernameStartingWith</span><span class="token punctuation">(</span><span class="token class-name">String</span> u<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>查询所有姓赵的、并且 id 大于 50 的人</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> <span class="token function">findByUsernameStartingWithAndIdGreaterThan</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">Long</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>查询所有姓名中包含&quot;上&quot;字的人</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> <span class="token function">findByUsernameContaining</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>查询所有姓赵的或者年龄大于 90 岁的</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> <span class="token function">findByUsernameStartingWithOrAgeGreaterThan</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">Long</span> age<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>查询所有角色为 1 的用户</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> <span class="token function">findByRole_Id</span><span class="token punctuation">(</span><span class="token class-name">Long</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="_2-2-3-2-支持的关键字"><a href="#_2-2-3-2-支持的关键字" class="header-anchor">#</a> 2.2.3.2 支持的关键字</h4> <p>支持的查询关键字如下图：</p> <p><img src="http://www.javaboy.org/images/boot2/23-5.png" alt=""></p> <h4 id="_2-2-3-3-查询方法流程解析"><a href="#_2-2-3-3-查询方法流程解析" class="header-anchor">#</a> 2.2.3.3 查询方法流程解析</h4> <p>为什么写上方法名，JPA就知道你想干嘛了呢？假如创建如下的查询：<code>findByUserDepUuid()</code>，框架在解析该方法时，首先剔除 findBy，然后对剩下的属性进行解析，假设查询实体为Doc：</p> <ol><li>先判断 userDepUuid （根据 POJO 规范，首字母变为小写）是否为查询实体的一个属性，如果是，则表示根据该属性进行查询；如果没有该属性，继续第二步；</li> <li>从右往左截取第一个大写字母开头的字符串(此处为 Uuid)，然后检查剩下的字符串是否为查询实体的一个属性，如果是，则表示根据该属性进行查询；如果没有该属性，则重复第二步，继续从右往左截取；最后假设 user 为查询实体的一个属性；</li> <li>接着处理剩下部分（DepUuid），先判断 user 所对应的类型是否有depUuid属性，如果有，则表示该方法最终是根据 “ Doc.user.depUuid” 的取值进行查询；否则继续按照步骤 2 的规则从右往左截取，最终表示根据 “Doc.user.dep.uuid” 的值进行查询。</li> <li>可能会存在一种特殊情况，比如 Doc 包含一个 user 的属性，也有一个 userDep 属性，此时会存在混淆。可以明确在属性之间加上 &quot;_&quot; 以显式表达意图，比如 &quot;findByUser_DepUuid()&quot; 或者 &quot;findByUserDep_uuid()&quot;</li> <li>还有一些特殊的参数：例如分页或排序的参数：</li></ol> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Page</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UserModel</span><span class="token punctuation">&gt;</span></span> <span class="token function">findByName</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">Pageable</span> pageable<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UserModel</span><span class="token punctuation">&gt;</span></span> <span class="token function">findByName</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">Sort</span> sort<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="_2-2-3-4-query-注解"><a href="#_2-2-3-4-query-注解" class="header-anchor">#</a> 2.2.3.4 @Query 注解</h4> <p>有的时候，这里提供的查询关键字并不能满足我们的查询需求，这个时候就可以使用 @Query 关键字，来自定义查询 SQL，例如查询 Id 最大的 User：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Query</span><span class="token punctuation">(</span><span class="token string">&quot;select u from t_user u where id=(select max(id) from t_user)&quot;</span><span class="token punctuation">)</span>
<span class="token class-name">User</span> <span class="token function">getMaxIdUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>如果查询有参数的话，参数有两种不同的传递方式，</p> <ul><li>利用下标索引传参，索引参数如下所示，索引值从1开始，查询中 ”?X” 个数需要与方法定义的参数个数相一致，并且顺序也要一致：</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Query</span><span class="token punctuation">(</span><span class="token string">&quot;select u from t_user u where id&gt;?1 and username like ?2&quot;</span><span class="token punctuation">)</span>
<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> <span class="token function">selectUserByParam</span><span class="token punctuation">(</span><span class="token class-name">Long</span> id<span class="token punctuation">,</span> <span class="token class-name">String</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>命名参数（推荐）：这种方式可以定义好参数名，赋值时采用@Param(&quot;参数名&quot;)，而不用管顺序：</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Query</span><span class="token punctuation">(</span><span class="token string">&quot;select u from t_user u where id&gt;:id and username like :name&quot;</span><span class="token punctuation">)</span>
<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> <span class="token function">selectUserByParam2</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Param</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span> <span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token annotation punctuation">@Param</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>查询时候，也可以是使用原生的 SQL 查询，如下：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Query</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;select * from t_user&quot;</span><span class="token punctuation">,</span>nativeQuery <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> <span class="token function">selectAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="_2-2-3-5-modifying-注解"><a href="#_2-2-3-5-modifying-注解" class="header-anchor">#</a> 2.2.3.5 @Modifying 注解</h4> <p>涉及到数据修改操作，可以使用 @Modifying 注解，@Query 与 @Modifying 这两个 annotation 一起声明，可定义个性化更新操作，例如涉及某些字段更新时最为常用，示例如下：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Modifying</span>
<span class="token annotation punctuation">@Query</span><span class="token punctuation">(</span><span class="token string">&quot;update t_user set age=:age where id&gt;:id&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">int</span> <span class="token function">updateUserById</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Param</span><span class="token punctuation">(</span><span class="token string">&quot;age&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> age<span class="token punctuation">,</span> <span class="token annotation punctuation">@Param</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>注意：</p> <ol><li>可以通过自定义的 JPQL 完成 UPDATE 和 DELETE 操作. 注意: JPQL 不支持使用 INSERT</li> <li>方法的返回值应该是 int，表示更新语句所影响的行数</li> <li>在调用的地方必须加事务，没有事务不能正常执行</li> <li>默认情况下, Spring Data 的每个方法上有事务, 但都是一个只读事务. 他们不能完成修改操作</li></ol> <p>说到这里，再来顺便说说 Spring Data 中的事务问题：</p> <ol><li>Spring Data 提供了默认的事务处理方式，即所有的查询均声明为只读事务。</li> <li>对于自定义的方法，如需改变 Spring Data 提供的事务默认方式，可以在方法上添加 @Transactional 注解。</li> <li>进行多个 Repository 操作时，也应该使它们在同一个事务中处理，按照分层架构的思想，这部分属于业务逻辑层，因此，需要在Service 层实现对多个 Repository 的调用，并在相应的方法上声明事务。</li></ol> <p>好了，关于Spring Data Jpa 本文就先说这么多。</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/springboot/mybatis-multidatasource.html" class="prev">
        整合 MyBatis 多数据源
      </a></span> <span class="next"><a href="/springboot/jpa.html">
        整合 Jpa
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.93cfb041.js" defer></script><script src="/assets/js/2.afd40777.js" defer></script><script src="/assets/js/123.adc5157d.js" defer></script>
  </body>
</html>
