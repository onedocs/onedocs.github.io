(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{396:function(t,a,s){"use strict";s.r(a);var o=s(42),v=Object(o.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("p",[t._v("上篇文章我们简单介绍了 MongoDB 安装以及启动命令，本文我们来看看基本的增删改查，对 MongoDB 有一个直观的认识。")]),t._v(" "),s("h2",{attrs:{id:"客户端安装配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#客户端安装配置"}},[t._v("#")]),t._v(" 客户端安装配置")]),t._v(" "),s("p",[t._v("上篇文章我们提到可以在 MongoDB 启动成功之后通过 mongo 命令进入 MongoDB 客户端，然后在客户端输入操作命令执行增删改查等操作。当然，我们也可以通过一些客户端工具来连接 MongoDB，比如 Robo 3T。")]),t._v(" "),s("p",[t._v("首先我们下载 Robo 3T(下载地址 https://robomongo.org/download )，下载成功之后解压，找到 .exe 可执行文件双击启动，启动后新建一个连接，输入 ip 地址("),s("strong",[t._v("注意连接之前要确保 Linux 上的 MongoDB 已经启动")]),t._v(")，如下：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://www.javaboy.org/images/mongodb/2-1.png",alt:"p223"}})]),t._v(" "),s("p",[t._v("连接成功之后，我们就可以看到数据库的信息了，如下：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://www.javaboy.org/images/mongodb/2-2.png",alt:"p224"}})]),t._v(" "),s("h2",{attrs:{id:"shell-简介"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#shell-简介"}},[t._v("#")]),t._v(" shell 简介")]),t._v(" "),s("p",[t._v("暂时我们所有的操作都先放在 test 数据库中进行(默认情况下，test 数据库为空，这里不显示空的数据库，此时执行可以选中 CentOS 菜单，右键单击点击 Open Shell，默认打开 test 数据库)，选中 test ，右键单击，选择 Open Shell，如下：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://www.javaboy.org/images/mongodb/2-3.png",alt:"p225"}})]),t._v(" "),s("p",[t._v("这里的 shell 是一个功能完整的 JavaScript 解释器，可以运行 JavaScript 程序，这个很好玩，如下我定义一个函数然后调用：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://www.javaboy.org/images/mongodb/2-4.png",alt:"p226"}})]),t._v(" "),s("p",[t._v("函数定义和调用的代码写好之后，按左上角的三角符号表示运行，也可以按 F5 或者 "),s("code",[t._v("Ctrl+Enter")]),t._v(" 组合键。我们也可以调用 JavaScript 的标准函数库，如下：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://www.javaboy.org/images/mongodb/2-5.png",alt:"p227"}})]),t._v(" "),s("p",[t._v("再比如调用Date函数，如下：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://www.javaboy.org/images/mongodb/2-6.png",alt:"p228"}})]),t._v(" "),s("p",[t._v("如果我们没有使用 Robo 3T 工具，而是直接在命令行通过 mongo 命令来启动 shell，如下：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://www.javaboy.org/images/mongodb/2-7.png",alt:"p229"}})]),t._v(" "),s("p",[t._v("此时，shell 会连接到 MongoDB 服务器的 test 数据库，并将数据库连接赋值给全局变量 db，我们将通过 db 这个变量实现很多功能，我们也可以查看 db 当前指向哪个数据库，直接使用 db 命令，如下：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://www.javaboy.org/images/mongodb/2-8.png",alt:"p230"}})]),t._v(" "),s("p",[t._v("再比如我们可以通过 use 命令来切换数据库（上文中也有用到过），如下：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://www.javaboy.org/images/mongodb/2-9.png",alt:"p231"}})]),t._v(" "),s("h2",{attrs:{id:"增"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#增"}},[t._v("#")]),t._v(" 增")]),t._v(" "),s("p",[t._v("在添加之前我们先来说说数据库的创建，上文我们提到了 use 命令，表示切换到某一个数据库中去，如果我们想切换到一个并不存在的数据库中去，系统就会自动的帮我们创建这个数据库。但是一个空的数据库系统并不会显示出来，往这个数据库中插入一条记录，我们就可以看到数据库存在了，如下：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://www.javaboy.org/images/mongodb/2-10.png",alt:"p232"}})]),t._v(" "),s("p",[t._v("在 MongoDB 中，我们插入的每一条记录都是一个 json 字符串，这个 json 字符串我们称作"),s("strong",[t._v("文档")]),t._v("，多个文档可以组成一个"),s("strong",[t._v("集合")]),t._v("，这个文档就类似于我们关系型数据库中的一行数据，而集合就类似于关系型数据库中的一张表，集合也不用专门去创建，直接输入向哪个集合中插入数据即可，此时集合就会被自动的创建出来了。")]),t._v(" "),s("p",[t._v("当然我们也可以批量的添加文档，如下("),s("strong",[t._v("批量添加一样也可以使用insert方法来完成")]),t._v(")：")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("db.sang_collect.insertMany([{x:1},{x:2},{x:3}])\n")])])]),s("p",[t._v("如果在插入某一个文档时出错，则其后面的文档就会插入失败，而在其之前已经插入的文档则不受影响，如下：")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("db.sang_collect.insertMany([{_id:99,x:99},{_id:99,x:98},{_id:97,x:97}])\n")])])]),s("p",[t._v("由于第二个文档的 "),s("code",[t._v("_id")]),t._v(" 字段与前面的重复，所以第二第三个文档插入失败，第一个文档则插入成功。")]),t._v(" "),s("h2",{attrs:{id:"查"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#查"}},[t._v("#")]),t._v(" 查")]),t._v(" "),s("p",[t._v("数据添加成功之后我们再来看看查询，利用 "),s("code",[t._v("db.sang.find()")]),t._v(" 方法我们可以查看所有文档(所有记录)，如果只查看一个文档(一条记录)，可以通过 "),s("code",[t._v("db.sang.findOne()")]),t._v(" 命令，在查看之前我先用一个 for 循环多插入几条数据，如下：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://www.javaboy.org/images/mongodb/2-11.png",alt:"p233"}})]),t._v(" "),s("p",[t._v("然后分别调用find和findOne方法查看，如下：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://www.javaboy.org/images/mongodb/2-12.png",alt:"p234"}})]),t._v(" "),s("p",[t._v("查出来的数据除了我们插入的 x 之外，还有一个 "),s("code",[t._v("_id")]),t._v(" 字段，这是系统自动为我们添加的字段，我们也可以自己传入 "),s("code",[t._v("_id")]),t._v(",但是 "),s("code",[t._v("_id")]),t._v(" 字段不能重复，如下：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://www.javaboy.org/images/mongodb/2-13.png",alt:"p235"}})]),t._v(" "),s("p",[t._v("find 和 findOne 中也可以传入查询参数，这个我们后面再详细说。")]),t._v(" "),s("h2",{attrs:{id:"改"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#改"}},[t._v("#")]),t._v(" 改")]),t._v(" "),s("p",[t._v("update 操作可以用来更新数据，它接收两个参数，第一个参数表示更新条件，第二个参数表示要更新的数据，比如我将所有 x:1 的数据改为 x:999,如下：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://www.javaboy.org/images/mongodb/2-14.png",alt:"p236"}})]),t._v(" "),s("h2",{attrs:{id:"删"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#删"}},[t._v("#")]),t._v(" 删")]),t._v(" "),s("p",[t._v("remove 操作可以用来删除数据，如下：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://www.javaboy.org/images/mongodb/2-15.png",alt:"p237"}})]),t._v(" "),s("h2",{attrs:{id:"shell-其他操作"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#shell-其他操作"}},[t._v("#")]),t._v(" shell 其他操作")]),t._v(" "),s("p",[t._v("我们也可以将要执行的脚本放在一个 js 文件中，在使用 shell 脚本时指定要执行的 js 文件，如下：")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("mongo ~/myjs.js\n")])])]),s("p",[t._v("shell 会依次执行 js 中的脚本，并在执行完成后退出。如下：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://www.javaboy.org/images/mongodb/2-16.png",alt:"p246"}})]),t._v(" "),s("p",[t._v("我的 js 脚本中是两行插入语句，此时我们重新进入到 shell 中，就可以看到刚刚的数据已经插入成功了。")]),t._v(" "),s("p",[t._v("如果有每次启动都要加载的 js 文件，我们可以将其内容放在 "),s("code",[t._v(".mongorc.js")]),t._v(" 文件中，该文件放在当前用户目录下，如下：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://www.javaboy.org/images/mongodb/2-17.png",alt:"p247"}})]),t._v(" "),s("p",[t._v("这样，每次启动都会打印一个 "),s("code",[t._v('"你好，欢迎使用MongoDB"')]),t._v(".")]),t._v(" "),s("p",[t._v("好了，MongoDB 的基本操作我们先说这么多，让各位小伙伴对 MongoDB 有一个基本的认识，后面的文章我们会详细的介绍 MongoDB 中增删改查的各种情况，敬请关注。")]),t._v(" "),s("p",[t._v("参考资料：")]),t._v(" "),s("ol",[s("li",[t._v("《MongoDB权威指南第2版》")])])])}),[],!1,null,null,null);a.default=v.exports}}]);